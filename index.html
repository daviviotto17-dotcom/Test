<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Ultimate Car Driving</title>
    <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/daviviotto17-dotcom/Test@main/favicon.ico">
    <link rel="stylesheet" href="https://github.com/daviviotto17-dotcom/Test/blob/main/style.css">
</head>

<body>
    <div class="webgl-content">
        <div id="gameContainer" class="unity-mobile">
            <canvas id="gameCanvas" style="cursor: default;"></canvas>
            <div id="loadingBlock" style="display: none;">
                <img class="logo" src="https://github.com/daviviotto17-dotcom/Test/blob/main/Logo.png">
                <span class="subtitle"><br></span>
                <div id="progressBar">
                    <div>LOADING ... (Classroom Center Site!)</div>
                    <div class="centered">
                        <div id="emptyBar" style="width: 0%;"></div>
                        <div id="fullBar" style="width: 100%;"></div>
                    </div>
                </div>
                <div id="warningBrowserBlock" style="display:none;">
                    <div class="warningBrowserText"></div>
                    <div class="browserIcons"></div>
                </div>
                <div id="warningMobileBlock" style="display: inherit;">
                    <div class="warningBrowserText">
                        Please note that Unity WebGL is not currently supported on mobiles.
                    </div>
                </div>
            </div>
            <div id="errorBrowserBlock" style="display:none;">
                <img class="logo" src="https://github.com/daviviotto17-dotcom/Test/blob/main/Logo.png">
                <span class="subtitle"><br></span>
                <div id="errorContent" style="display:none;">
                    <div class="errorBrowserText"></div>
                    <div class="browserIcons"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function ToggleFullScreen() {
            var isInFullScreen = (document.fullscreenElement && document.fullscreenElement !== null) ||
                (document.webkitFullscreenElement && document.webkitFullscreenElement !== null) ||
                (document.msFullscreenElement && document.msFullscreenElement !== null);

            var element = document.body.getElementsByClassName("webgl-content")[0];

            if (!isInFullScreen) {
                if (element.webkitRequestFullscreen) {
                    element.webkitRequestFullscreen();
                } else if (element.msRequestFullscreen) {
                    element.msRequestFullscreen();
                } else if (element.requestFullscreen) {
                    element.requestFullscreen();
                }
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
            }
        }

        function CheckCompatibility() {
            if (!hasWebGL()) {
                document.getElementById("errorBrowserBlock").style.display = "inherit";
            } else if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                document.getElementById("warningMobileBlock").style.display = "inherit";
            } else if (!isFirefox && !isSafari && !isChrome) {
                document.getElementById("warningBrowserBlock").style.display = "inherit";
            }
        }

        function hasWebGL() {
            var supported;
            try {
                var canvas = document.createElement('canvas');
                supported = !!window.WebGLRenderingContext && (canvas.getContext('webgl') || canvas.getContext('experimental-webgl'));
            } catch (e) {
                supported = false;
            }

            try {
                eval('let foo = 123;');
            } catch (e) {
                supported = false;
            }
            canvas = undefined;
            return supported;
        }

        var isFirefox = typeof InstallTrigger !== 'undefined';
        var isSafari = /constructor/i.test(window.HTMLElement) ||
            (function(p) {
                return p.toString() === "[object SafariRemoteNotification]";
            })
            (!window['safari'] || (typeof safari !== 'undefined' && safari.pushNotification));
        var isChromium = window.chrome;
        var winNav = window.navigator;
        var vendorName = winNav.vendor;
        var isOpera = typeof window.opr !== "undefined";
        var isIEedge = winNav.userAgent.indexOf("Edge") > -1;
        var isIOSChrome = winNav.userAgent.match("CriOS");
        var isChrome = isIOSChrome ||
            (isChromium !== null && typeof isChromium !== "undefined" && vendorName === "Google Inc." && isOpera === false && isIEedge === false);

        var buildUrl = "";
        var loaderUrl = "fb9502bc7610d9c812fd76745164ef27.js";
        var config = {
            dataUrl: "",
            frameworkUrl: "59f116a01ba156009be1331a920ead96.js.unityweb",
            codeUrl: "https://cdn.jsdelivr.net/gh/daviviotto17-dotcom/Test@main/c04f87f256d6238c834e76a761d263d1.wasm.unityweb",
            streamingAssetsUrl: "",
            companyName: "Gamebol",
            productName: "Ultimate Car Driving",
            productVersion: "1.0",
        };

        var container = document.querySelector("#gameContainer");
        var canvas = document.querySelector("#gameCanvas");
        var loadingBar = document.querySelector("#loadingBlock");
        var progressBarFull = document.querySelector("#fullBar");
        var progressBarEmpty = document.querySelector("#emptyBar");

        if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
            container.className = "unity-mobile";
            config.devicePixelRatio = 1;
        }
        CheckCompatibility();

        async function loadDataFile() {
            const parts = [
                "0aff4ee936778b905d874c8c2fb40213.data.unityweb.part1",
                "0aff4ee936778b905d874c8c2fb40213.data.unityweb.part2",
                "0aff4ee936778b905d874c8c2fb40213.data.unityweb.part3",
                "0aff4ee936778b905d874c8c2fb40213.data.unityweb.part4",
                "0aff4ee936778b905d874c8c2fb40213.data.unityweb.part5"
            ];

            let buffers = [];
            for (let url of parts) {
                const resp = await fetch(url);
                const buf = await resp.arrayBuffer();
                buffers.push(buf);
            }

            let totalLength = buffers.reduce((a, b) => a + b.byteLength, 0);
            let tmp = new Uint8Array(totalLength);
            let offset = 0;
            for (let b of buffers) {
                tmp.set(new Uint8Array(b), offset);
                offset += b.byteLength;
            }

            let blob = new Blob([tmp]);
            config.dataUrl = URL.createObjectURL(blob);
        }

        async function loadGame() {
            await loadDataFile();

            var script = document.createElement("script");
            script.src = loaderUrl;
            script.onload = () => {
                createUnityInstance(canvas, config, (progress) => {
                    progressBarFull.style.width = 100 * progress + "%";
                    progressBarEmpty.style.width = (100 * (1 - progress)) + "%";
                }).then((unityInstance) => {
                    loadingBar.style.display = "none";
                }).catch((message) => {
                    alert(message);
                });
            };
            document.body.appendChild(script);
        }

        loadGame();
    </script>
    <style>
  /* CARREGAMENTO OVERLAY! */
  .loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #f1f1f1; /* Cor de fundo da tela de carregamento */
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    transition: opacity 1s ease-in-out;
  }

  .loading-container {
    width: 300px;
    text-align: center;
  }

  .loading-text {
    font-family: sans-serif;
    font-size: 1.2rem;
    color: #333;
    margin-bottom: 15px;
  }

  /* Estilos para a barra de progresso */
  .loading-bar-container {
    width: 100%;
    height: 15px;
    background-color: #ddd; /* Cor da barra vazia */
    border-radius: 10px;
    overflow: hidden;
  }

  .loading-bar-fill {
    height: 100%;
    width: 0;
    background-color: #4CAF50; /* Cor da barra cheia */
    border-radius: 10px;
    animation: fillBar 8s ease-in-out forwards;
  }

  /* Animação para preencher a barra */
  @keyframes fillBar {
    from {
      width: 0;
    }
    to {
      width: 100%;
    }
  }
</style>

<div class="loading-overlay" id="loadingOverlay">
  <div class="loading-container">
    <div class="loading-text">Carregando...</div>
    <div class="loading-bar-container">
      <div class="loading-bar-fill"></div>
    </div>
  </div>
</div>

<script>
  // Script para esconder a tela de carregamento após a animação
  window.addEventListener('load', () => {
    const loadingOverlay = document.getElementById('loadingOverlay');
    
    // A animação da barra de progressos (definido no CSS)
    // Usamos um setTimeout para garantir que a tela de carregamento
    // só desaparecerá após a barra estar completamente cheia.
    setTimeout(() => {
      loadingOverlay.style.opacity = '0';
      
      // Remove a tela de carregamento completamente do DOM após a transição
      // para que ela não interfira mais na interação com a página.
      setTimeout(() => {
        loadingOverlay.style.display = 'none';
      }, 870); // Este tempo deve ser igual à transição de opacidade do CSS
      
    }, 7000);
  });
</script><!--Api full screen deita tela-->
<div id="overlay" style="
  position:fixed;
  top:0; left:0;
  width:100vw; height:100vh;
  background:transparent;
  z-index:9999;
  cursor:pointer;
"></div>

<script>
  const overlay = document.getElementById("overlay");

  function enterFullscreen() {
    const elem = document.documentElement;
    if (elem.requestFullscreen) {
      elem.requestFullscreen();
    } else if (elem.webkitRequestFullscreen) { /* Safari */
      elem.webkitRequestFullscreen();
    } else if (elem.msRequestFullscreen) { /* IE11 */
      elem.msRequestFullscreen();
    }
  }

  function lockScreenOrientation() {
    if (screen.orientation && screen.orientation.lock) {
      screen.orientation.lock('landscape').catch((err) => {
        console.warn("Não foi possível bloquear a orientação da tela:", err);
      });
    } else {
      console.warn("A API de orientação de tela não é suportada ou a permissão foi negada.");
    }
  }

  overlay.addEventListener("click", () => {
    overlay.style.display = "none";
    enterFullscreen();
    // Adicione um pequeno atraso para garantir que a tela cheia seja ativada
    // antes de tentar alterar a orientação.
    setTimeout(() => {
      lockScreenOrientation();
    }, 500);
  });

  document.addEventListener("fullscreenchange", () => {
    if (!document.fullscreenElement) {
      overlay.style.display = "block";
    }
  });

</script>

</body>
</html>
